{"version":13,"variables":[{"key":"projectname","type":"query","input":"fetch spans\n| filter gitlab.source == \"gitlab-exporter\"\n| summarize collectDistinct(service.name)","multiple":true}],"tiles":{"0":{"type":"data","title":"","query":"fetch spans\n| filter in(service.name, $projectname)\n| summarize countDistinct(pipeline.project_id), alias:Projects","davis":{"enabled":false},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"k8s.container.name","categoryAxisLabel":"k8s.container.name","valueAxis":"thread.id","valueAxisLabel":"thread.id"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["thread.id"],"leftAxisDimensions":["k8s.container.name"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Projects"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Projects","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"1":{"type":"data","title":"","query":"fetch spans\n| filter in(service.name, $projectname)\n| summarize countDistinct(runner.name), alias:Runners","davis":{"enabled":false},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["finished_at"],"leftAxisDimensions":["runner.paused"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Runners"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Runners","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"2":{"type":"data","title":"","query":"fetch spans\n| filter in(service.name, $projectname)\n| summarize countDistinct(pipeline.id), alias:Pipelines","davis":{"enabled":false},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["finished_at"],"leftAxisDimensions":["runner.paused"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Pipelines"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Pipelines","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"3":{"type":"data","title":"","query":"fetch spans\n| filter in(service.name, $projectname)\n| fieldsAdd success= if (pipeline.status ==\"success\",pipeline.id)\n| summarize `Pipeline Success Rate` = (toDouble(countDistinct(success))/toDouble(countDistinct(pipeline.id))*100)","davis":{"enabled":false},"visualization":"singleValue","visualizationSettings":{"thresholds":[{"id":1,"field":"","title":"","isEnabled":true,"rules":[{"id":0,"color":{"Default":"var(--dt-colors-charts-categorical-color-09-default, #649438)"},"comparator":"≥","label":"","value":80},{"id":1,"color":{"Default":"var(--dt-colors-charts-categorical-color-14-default, #d56b1a)"},"comparator":"≥","label":"","value":60},{"id":2,"color":{"Default":"var(--dt-colors-charts-categorical-color-12-default, #cd3741)"},"comparator":"≤","label":"","value":60}]}],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Pipeline Success Rate"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"unitsOverrides":[{"identifier":"Pipeline Success Rate","unitCategory":"percentage","baseUnit":"percent","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704732370643}],"histogram":{"dataMappings":[{"valueAxis":"Pipeline Success Rate","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"4":{"type":"data","title":"Average Job Queued Time","query":"fetch spans\n| filter in(service.name, $projectname)\n| makeTimeseries avg(toDouble(queued_duration)), time:start_time","davis":{"enabled":false},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(toDouble(queued_duration))"],"leftAxisDimensions":[]},"legend":{"hidden":true}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"error\"]":107.921875,"[\"queued_duration\"]":230.9375,"[\"count\"]":83.953125,"[\"bin(timestamep, 1m)\"]":208.125,"[\"sum(duration)\"]":139.46875,"[\"bin(timestamp, 1m)\"]":191.65625}},"unitsOverrides":[{"identifier":"avg(toDouble(queued_duration))","unitCategory":"time","baseUnit":"second","displayUnit":null,"decimals":1,"suffix":"","delimiter":false,"added":1704748112400}]}},"5":{"type":"data","title":"Average Job Duration","query":"fetch spans\n| filter in(service.name, $projectname)\n| filter duration != \"NULL\"\n| filter status != \"skipped\"\n| makeTimeseries `duration`=avg(duration), time:start_time","davis":{"enabled":false},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["duration"],"leftAxisDimensions":[]},"leftYAxisSettings":{"scale":"linear"},"legend":{"hidden":true}},"singleValue":{"alignment":"center","label":"","autoscale":true},"table":{"hiddenColumns":[],"lineWrapIds":[]},"unitsOverrides":[{"identifier":"duration","unitCategory":"time","baseUnit":"nanosecond","displayUnit":null,"decimals":1,"suffix":"","delimiter":false,"added":1704484571245}]}},"6":{"type":"data","title":"Average Stage Duration","query":"fetch spans\n| filter in(service.name, $projectname)\n| filter duration != \"NULL\"\n| filter status != \"skipped\"\n| summarize `duration`=avg(duration), by:{stage}","davis":{"enabled":false},"visualization":"pieChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative","hideLabels":false},"categoryOverrides":{},"categoricalBarChartSettings":{"valueAxis":"duration","valueAxisLabel":"duration","categoryAxis":"stage","categoryAxisLabel":"stage"},"colorPalette":"blue-steel","legend":{"position":"auto","hidden":false}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"stage"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"duration","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"7":{"type":"data","title":"Runner Status","query":"fetch spans\n| filter in(service.name, $projectname)\n| filter runner.status !=\"NULL\"\n| fields runner.description, runner.status, start_time\n| summarize {d=takeMax( record(start_time, runner.status) )}, by:{runner.description}\n| fieldsFlatten d\n| fields `Runner Name` = runner.description, `Runner Status ` = if(d.runner.status==\"offline\", \"Offline ❌ \", else:\"Online ✅ \")//`Runner Status`=d.runner.status","davis":{"enabled":false},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect"},"singleValue":{"alignment":"center","label":"","autoscale":true,"recordField":"Runner Name"},"table":{"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"runner.description\"]":386.328125,"[\"runner status\"]":147.421875,"[\"Runner Name\"]":410.328125,"[\"Runner Status\"]":152.078125,"[\"Runner Status \"]":153}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"8":{"type":"data","title":"Job Analysis","query":"fetch spans\n| filter in(service.name, $projectname)\n| fields start_time, pipeline.web_url, stage, span.name, id, duration, pipeline.status, failure_reason\n| sort start_time desc","davis":{"enabled":false},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["finished_at"],"leftAxisDimensions":["runner.paused"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"start_time"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}}}},"9":{"type":"data","title":"Latest Project Logs","query":"fetch logs\n| filter in(service.name, $projectname)\n| fields timestamp, content, status, service.name, otelTraceId \n| sort timestamp desc\n| limit 20","davis":{"enabled":false},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"loglevel","categoryAxisLabel":"loglevel","valueAxis":"count()","valueAxisLabel":"count()"}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"timestamp"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[["content"]],"columnWidths":{"[\"timestamp\"]":147.15625,"[\"content\"]":404.390625,"[\"event.type\"]":114.703125,"[\"loglevel\"]":97.671875,"[\"service.name\"]":248.546875,"[\"status\"]":157.53125,"[\"before_sha\"]":333.453125,"[\"created_at\"]":188.265625,"[\"detailed_status.details_path\"]":232.421875,"[\"detailed_status.favicon\"]":600,"[\"detailed_status.group\"]":188.828125,"[\"detailed_status.has_details\"]":225.890625,"[\"detailed_status.icon\"]":178.015625,"[\"detailed_status.illustration\"]":222.4375,"[\"detailed_status.label\"]":183.296875,"[\"detailed_status.text\"]":177.375,"[\"detailed_status.tooltip\"]":193.46875,"[\"dt.auth.origin\"]":261.9375,"[\"duration\"]":102.125,"[\"finished_at\"]":188.265625,"[\"gitlab.resource.type\"]":174.953125,"[\"gitlab.source\"]":161.34375,"[\"id\"]":59.578125,"[\"iid\"]":63.296875,"[\"instrumentation.name\"]":191.53125,"[\"log_size\"]":100.765625,"[\"otel.scope.name\"]":225.359375,"[\"otelSpanID\"]":135.5,"[\"otelTraceID\"]":262,"[\"otelTraceSampled\"]":163.71875,"[\"project_id\"]":112.265625,"[\"queued_duration\"]":156.9375,"[\"ref\"]":66.453125,"[\"sha\"]":327.328125,"[\"source\"]":90.484375,"[\"started_at\"]":188.265625,"[\"tag\"]":68.984375,"[\"updated_at\"]":188.265625,"[\"user.avatar_url\"]":589.75,"[\"user.id\"]":90.4375,"[\"user.locked\"]":120.03125,"[\"user.name\"]":114.765625,"[\"user.state\"]":111.796875,"[\"user.username\"]":143.03125,"[\"user.web_url\"]":245.546875,"[\"web_url\"]":427.140625,"[\"dt.entity.service\"]":204.71875,"[\"dt.source_entity\"]":204.71875,"[\"job_id\"]":86.859375,"[\"message\"]":339.125,"[\"pipeline_id\"]":117.984375,"[\"span_id\"]":135.5,"[\"stage.name\"]":129.046875,"[\"trace_id\"]":262,"[\"otelTraceId\"]":120.84375}}}},"10":{"type":"data","title":"Average Pipeline Duration","query":"fetch spans\n| filter service.name == \"demo/srg-pipeline\"\n| filter duration != \"NULL\"\n| summarize `totalduration`=sum(toDouble(duration)), by:{pipeline.id, start_time}\n| makeTimeseries avg(totalduration), time:start_time","davis":{"enabled":false},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(totalduration)"],"leftAxisDimensions":[],"fields":[],"values":[]},"leftYAxisSettings":{"scale":"linear"},"colorPalette":"categorical","legend":{"hidden":true}},"singleValue":{"alignment":"center","label":"","autoscale":true},"table":{"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"duration (s)\"]":135,"[\"pipeline.id\"]":125.4375}},"unitsOverrides":[{"identifier":"avg(totalduration)","unitCategory":"time","baseUnit":"nanosecond","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704484571245}],"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"11":{"type":"data","title":"Average Pipeline Queued Duration","query":"fetch spans\n| filter service.name == \"demo/srg-pipeline\"\n| filter duration != \"NULL\"\n| summarize `totalduration`=sum(toDouble(queued_duration)), by:{pipeline.id, start_time}\n| makeTimeseries avg(totalduration), time:start_time","davis":{"enabled":false},"visualization":"barChart","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"timeframe","leftAxisValues":["avg(totalduration)"],"leftAxisDimensions":[],"fields":[],"values":[]},"leftYAxisSettings":{"scale":"linear"},"legend":{"hidden":true}},"singleValue":{"alignment":"center","label":"","autoscale":true},"table":{"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"duration (s)\"]":135,"[\"pipeline.id\"]":125.4375}},"unitsOverrides":[{"identifier":"avg(totalduration)","unitCategory":"time","baseUnit":"second","displayUnit":null,"decimals":2,"suffix":"","delimiter":false,"added":1704484571245}],"histogram":{"dataMappings":[{"valueAxis":"interval","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"12":{"type":"markdown","title":"","content":"![](https://images.ctfassets.net/xz1dnu24egyd/1IRkfXmxo8VP2RAE5jiS1Q/ea2086675d87911b0ce2d34c354b3711/gitlab-logo-500.png)"},"13":{"type":"data","title":"Recent Failures","query":"fetch spans\n| filter gitlab.source == \"gitlab-exporter\"\n| filter in(service.name, $projectname)\n| filter pipeline.status == \"failed\"\n| filter failure_reason != \"null\"\n| fields start_time, project = service.name, failure_reason, web_url\n| sort start_time desc\n| limit 10","davis":{"enabled":false},"visualization":"table","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"runner.paused","categoryAxisLabel":"runner.paused","valueAxis":"finished_at","valueAxisLabel":"finished_at"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["finished_at"],"leftAxisDimensions":["runner.paused"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"start_time"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{"[\"start_time\"]":147.15625,"[\"project\"]":126.546875,"[\"failure_reason\"]":120.5625,"[\"web_url\"]":405.078125}},"histogram":{"dataMappings":[]},"honeycomb":{"shape":"square"}}},"14":{"type":"data","title":"","query":"fetch spans\n| filter in(service.name, $projectname)\n| summarize countDistinct(job_id), alias:Jobs","davis":{"enabled":false},"visualization":"singleValue","visualizationSettings":{"thresholds":[],"chartSettings":{"gapPolicy":"connect","circleChartSettings":{"groupingThresholdType":"relative","groupingThresholdValue":0,"valueType":"relative"},"categoryOverrides":{},"categoricalBarChartSettings":{"categoryAxis":"k8s.container.name","categoryAxisLabel":"k8s.container.name","valueAxis":"thread.id","valueAxisLabel":"thread.id"},"fieldMapping":{"timestamp":"start_time","leftAxisValues":["thread.id"],"leftAxisDimensions":["k8s.container.name"]}},"singleValue":{"showLabel":true,"label":"","prefixIcon":"","autoscale":true,"alignment":"center","recordField":"Jobs"},"table":{"rowDensity":"condensed","enableSparklines":false,"hiddenColumns":[],"lineWrapIds":[],"columnWidths":{}},"histogram":{"dataMappings":[{"valueAxis":"Jobs","rangeAxis":""}]},"honeycomb":{"shape":"square"}}},"15":{"type":"markdown","title":"","content":"[Trace/Span Analysis](https://bwm98081.apps.dynatrace.com/ui/apps/dynatrace.classic.distributed.traces/ui/services/SERVICE-4301B253A35AF431/purepaths?gtf=-6h&gf=all)"},"16":{"type":"markdown","title":"","content":"[Failure Details](https://bwm98081.apps.dynatrace.com/ui/apps/dynatrace.classic.distributed.traces/ui/services/SERVICE-4301B253A35AF431/purepaths?gtf=-6h&gf=all&servicefilter=0%1E3%110)"}},"layouts":{"0":{"x":6,"y":0,"w":3,"h":3},"1":{"x":9,"y":3,"w":3,"h":3},"2":{"x":9,"y":0,"w":3,"h":3},"3":{"x":12,"y":0,"w":12,"h":3},"4":{"x":12,"y":18,"w":12,"h":7},"5":{"x":0,"y":18,"w":12,"h":7},"6":{"x":0,"y":6,"w":12,"h":6},"7":{"x":12,"y":3,"w":12,"h":3},"8":{"x":0,"y":25,"w":24,"h":6},"9":{"x":0,"y":32,"w":24,"h":6},"10":{"x":0,"y":12,"w":12,"h":6},"11":{"x":12,"y":12,"w":12,"h":6},"12":{"x":0,"y":0,"w":6,"h":6},"13":{"x":12,"y":6,"w":12,"h":5},"14":{"x":6,"y":3,"w":3,"h":3},"15":{"x":0,"y":31,"w":24,"h":1},"16":{"x":12,"y":11,"w":12,"h":1}}}